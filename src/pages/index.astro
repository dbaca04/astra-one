---
import ContentPage from "../layouts/ContentPage.astro";
import { getCollection } from "astro:content";
import FormattedDate from "../components/FormattedDate.astro";
import type { CollectionEntry } from "astro:content";
import type { BlogSchema } from "../types";

// Get all blog entries and sort them by date
const allPosts = await getCollection("blog");
// Type assertion for the schema
interface BlogPost extends CollectionEntry<"blog"> {
	data: BlogSchema;
	slug: string;
}
// Cast and sort by date (newest first)
const latestPosts = allPosts
	.sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf())
	.slice(0, 5) as BlogPost[]; // Get only the 5 most recent posts

// console.log("Latest Posts:", latestPosts); // Removed debugging console log

// Define the main sections of the site
const sections = [
	{
		title: "Code",
		description: "Explore coding examples, snippets, and best practices",
		url: "/code",
		icon: "üíª",
	},
	{
		title: "Create",
		description: "AI-driven creative tools and content generation",
		url: "/create",
		icon: "üé®",
	},
	{
		title: "Discover",
		description: "Research and insights about emerging AI technologies",
		url: "/discover",
		icon: "üîç",
	},
	{
		title: "Automate",
		description: "Automation techniques and workflows using AI",
		url: "/automate",
		icon: "‚öôÔ∏è",
	},
	{
		title: "Journal",
		description: "Personal experiences and reflections on working with AI",
		url: "/journal",
		icon: "üìî",
	},
];
---

<ContentPage
	title="Astra One"
	description="Exploring the intersection of AI, creativity, and productivity"
>
	<div class="hero">
		<h2>Welcome to Astra One</h2>
		<p class="tagline">
			Exploring the intersection of AI, creativity, and productivity
		</p>
		<p class="intro">
			This site is a collection of experiences, resources, and insights
			about working with AI tools to enhance both creative and technical
			workflows. Join me on this journey of discovery as we navigate the
			rapidly evolving landscape of artificial intelligence.
		</p>
	</div>

	<section class="main-sections">
		<h3>Explore Areas</h3>
		<div class="section-grid">
			{
				sections.map((section) => (
					<a href={section.url} class="section-card">
						<div class="section-icon">{section.icon}</div>
						<h4>{section.title}</h4>
						<p>{section.description}</p>
					</a>
				))
			}
		</div>
	</section>

	<section class="latest-posts">
		<h3>Latest Articles</h3>
		{
			latestPosts.length > 0 ? (
				<ul class="post-list">
					{latestPosts.map((post) => (
						<li class="post-item">
							<a href={`/blog/${post.id}`}>
								<h4>{post.data.title}</h4>
								<div class="post-meta">
									<span class="post-section">
										{post.data.section}
									</span>
									<span class="post-date">
										<FormattedDate
											date={post.data.pubDate}
										/>
									</span>
								</div>
								<p class="post-description">
									{post.data.description}
								</p>
							</a>
						</li>
					))}
				</ul>
			) : (
				<p>No articles published yet. Check back soon!</p>
			)
		}
	</section>
</ContentPage>

<style>
	.hero {
		text-align: center;
		padding: 2rem 0;
		margin-bottom: 2rem;
	}

	.tagline {
		font-size: 1.25rem;
		color: var(--accent);
		margin: 0.5rem 0 1.5rem;
	}

	.intro {
		max-width: 80%;
		margin: 0 auto;
		line-height: 1.6;
	}

	.main-sections {
		margin: 3rem 0;
	}

	.section-grid {
		display: grid;
		grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
		gap: 1.5rem;
		margin-top: 1.5rem;
	}

	.section-card {
		background-color: var(--gray-50, #f9fafb);
		border-radius: 8px;
		padding: 1.5rem;
		text-decoration: none;
		color: inherit;
		transition:
			transform 0.2s ease,
			box-shadow 0.2s ease;
		box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
	}

	.section-card:hover {
		transform: translateY(-4px);
		box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
	}

	.section-icon {
		font-size: 2rem;
		margin-bottom: 1rem;
	}

	.section-card h4 {
		margin: 0.5rem 0;
		color: var(--accent);
	}

	.section-card p {
		margin: 0;
		font-size: 0.9rem;
	}

	.latest-posts {
		margin: 3rem 0;
	}

	.post-list {
		list-style-type: none;
		padding: 0;
		margin: 2rem 0;
	}

	.post-item {
		margin-bottom: 2rem;
		border-bottom: 1px solid #eee;
		padding-bottom: 1rem;
	}

	.post-item a {
		text-decoration: none;
		color: inherit;
		display: block;
	}

	.post-item a:hover h4 {
		color: var(--accent);
	}

	.post-meta {
		display: flex;
		align-items: center;
		gap: 1rem;
		font-size: 0.85rem;
		margin: 0.5rem 0;
	}

	.post-section {
		text-transform: uppercase;
		background-color: var(--accent-light, #f0f0ff);
		color: var(--accent, #2937f0);
		padding: 0.25rem 0.5rem;
		border-radius: 4px;
	}

	.post-date {
		color: #666;
	}

	.post-description {
		margin-top: 0.5rem;
		line-height: 1.5;
	}
</style>
