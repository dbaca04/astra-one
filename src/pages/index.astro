---
import ContentPage from "../layouts/ContentPage.astro";
import { getCollection } from "astro:content";
import FormattedDate from "../components/FormattedDate.astro";
import type { CollectionEntry } from "astro:content";
import type { BlogSchema } from "../types";

// Get all blog entries and sort them by date
const allPosts = await getCollection("blog");
// Type assertion for the schema
interface BlogPost extends CollectionEntry<"blog"> {
	data: BlogSchema;
	slug: string;
}
// Cast and sort by date (newest first)
const latestPosts = allPosts
	.sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf())
	.slice(0, 5) as BlogPost[]; // Get only the 5 most recent posts

// console.log("Latest Posts:", latestPosts); // Removed debugging console log

// Define the main sections of the site
const sections = [
	{
		title: "Code",
		description: "Explore coding examples, snippets, and best practices",
		url: "/code",
		icon: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="2" y="3" width="20" height="14" rx="2" ry="2"></rect><line x1="8" y1="21" x2="16" y2="21"></line><line x1="12" y1="17" x2="12" y2="21"></line></svg>`,
	},
	{
		title: "Create",
		description: "AI-driven creative tools and content generation",
		url: "/create",
		icon: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><circle cx="8" cy="8" r="2"></circle><circle cx="16" cy="8" r="2"></circle><circle cx="8" cy="16" r="2"></circle><circle cx="16" cy="16" r="2"></circle></svg>`,
	},
	{
		title: "Automate",
		description: "Automation techniques and workflows using AI",
		url: "/automate",
		icon: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="3"></circle><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path></svg>`,
	},
	{
		title: "Journal",
		description: "Personal experiences and reflections on working with AI",
		url: "/journal",
		icon: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line><line x1="10" y1="9" x2="8" y2="9"></line></svg>`,
	},
];
---

<ContentPage
	title="Domdhi"
	description="Exploring the intersection of AI, creativity, and productivity"
>
	<div class="hero">
		<h2>Welcome to Domdhi</h2>
		<p class="tagline">
			Exploring the intersection of AI, creativity, and productivity
		</p>
		<p class="intro">
			This site is a collection of experiences, resources, and insights
			about working with AI tools to enhance both creative and technical
			workflows. Join me on this journey of discovery as we navigate the
			rapidly evolving landscape of artificial intelligence.
		</p>
	</div>

	<section class="main-sections">
		<h3>Explore Areas</h3>
		<div class="section-grid">
			{
				sections.map((section) => (
					<a href={section.url} class="section-card">
						<div class="section-icon" set:html={section.icon} />
						<h4>{section.title}</h4>
						<p>{section.description}</p>
					</a>
				))
			}
		</div>
	</section>

	<section class="latest-posts">
		<h3>Latest Articles</h3>
		{
			latestPosts.length > 0 ? (
				<ul class="post-list">
					{latestPosts.map((post) => (
						<li class="post-item">
							<a href={`/blog/${post.id}`}>
								<h4>{post.data.title}</h4>
								<div class="post-meta">
									<span class="post-section">
										{post.data.section}
									</span>
									<span class="post-date">
										<FormattedDate
											date={post.data.pubDate}
										/>
									</span>
								</div>
								<p class="post-description">
									{post.data.description}
								</p>
							</a>
						</li>
					))}
				</ul>
			) : (
				<p>No articles published yet. Check back soon!</p>
			)
		}
	</section>
</ContentPage>

<style>
	.hero {
		text-align: center;
		padding: 2rem 0;
		margin-bottom: 2rem;
	}

	.tagline {
		font-size: 1.25rem;
		color: var(--theme-accent);
		margin: 0.5rem 0 1.5rem;
	}

	.intro {
		max-width: 80%;
		margin: 0 auto;
		line-height: 1.6;
	}

	.main-sections {
		margin: 3rem 0;
	}

	.section-grid {
		display: grid;
		grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
		gap: 1.5rem;
		margin-top: 1.5rem;
	}

	.section-card {
		background-color: var(--theme-card-bg);
		border-radius: 8px;
		padding: 1.5rem;
		text-decoration: none;
		color: var(--theme-text);
		transition:
			transform 0.2s ease,
			box-shadow 0.3s ease,
			background-color 0.3s ease;
		box-shadow: var(--box-shadow-small);
		border: 1px solid var(--theme-border);
	}

	.section-card:hover,
	.section-card:focus {
		transform: translateY(-4px);
		box-shadow: var(--box-shadow-hover);
	}

	.section-card:focus-visible {
		outline: 2px solid var(--theme-accent);
		outline-offset: 2px;
	}

	.section-icon {
		font-size: 2.5rem;
		margin-bottom: 1rem;
		display: flex;
		align-items: center;
		justify-content: center;
		background-color: var(--theme-selection-bg);
		padding: 1rem;
		border-radius: 50%;
		box-shadow: var(--box-shadow-small);
		width: 70px;
		height: 70px;
	}

	.section-icon svg {
		width: 32px;
		height: 32px;
		stroke: var(--theme-accent);
		transition: all 0.2s ease;
	}

	.section-card:hover .section-icon svg,
	.section-card:focus .section-icon svg {
		stroke: var(--theme-accent-dark);
		transform: scale(1.1);
	}

	.section-card h4 {
		margin: 0.5rem 0;
		color: var(--theme-accent);
		font-size: 1.2rem;
		font-weight: 700;
	}

	.section-card p {
		margin: 0.5rem 0 0;
		font-size: 1rem;
		line-height: 1.5;
		color: var(--theme-text);
	}

	.latest-posts {
		margin: 3rem 0;
	}

	.post-list {
		list-style-type: none;
		padding: 0;
		margin: 2rem 0;
	}

	.post-item {
		margin-bottom: 2rem;
		border-bottom: 1px solid var(--theme-border);
		padding-bottom: 1rem;
	}

	.post-item a {
		text-decoration: none;
		color: inherit;
		display: block;
	}

	.post-item a:hover h4 {
		color: var(--theme-accent);
	}

	.post-meta {
		display: flex;
		align-items: center;
		gap: 1rem;
		font-size: 0.85rem;
		margin: 0.5rem 0;
	}

	.post-section {
		text-transform: uppercase;
		background-color: var(--theme-selection-bg);
		color: var(--theme-accent);
		padding: 0.25rem 0.5rem;
		border-radius: 4px;
		box-shadow: var(--box-shadow-small);
		transition: box-shadow 0.3s ease;
	}

	.post-date {
		color: var(--theme-text);
		opacity: 0.8;
	}

	.post-description {
		margin-top: 0.5rem;
		line-height: 1.5;
	}
</style>
